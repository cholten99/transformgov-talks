<IfModule mod_ssl.c>
<VirtualHost *:443>

    ServerName transformgov.org.uk
    ServerAlias www.transformgov.org.uk
    DocumentRoot /var/www/transformgov-talks

    # Default index files (serve SSI page)
    DirectoryIndex index.shtml index.html

    # Enable SSI for .shtml (additive Options)
    <Directory /var/www/transformgov-talks>
        Options +Includes +FollowSymLinks
        AllowOverride All
        Require all granted
        AddOutputFilter INCLUDES .shtml
    </Directory>

    # Allow SSI subrequests to /includes (filesystem)
    <Directory /var/www/transformgov-talks/includes>
        Require all granted
        Options +Includes
    </Directory>

    # Also allow the URL path /includes/* (for virtual includes)
    <Location "/includes/">
        Require all granted
    </Location>

    # Error page
    ErrorDocument 404 /404.shtml

    SSLEngine on
    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/transformgov.org.uk/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/transformgov.org.uk/privkey.pem

    ErrorLog ${APACHE_LOG_DIR}/tgt-ssl-error.log
    CustomLog ${APACHE_LOG_DIR}/tgt-ssl-access.log combined

</VirtualHost>
</IfModule>
